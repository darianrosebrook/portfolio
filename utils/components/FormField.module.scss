@use '../../ui/designTokens' as tokens;

// Base selectors must come before nested ones for proper specificity ordering
.label {
  display: block;
  margin-bottom: var(--space-xs, 0.25rem);
  color: var(--color-text-primary, #333333);
  font-weight: var(--font-weight-medium, 500);
  font-size: var(--text-size-base, 1rem);
  line-height: var(--text-line-height-tight, 1.25);

  @media (prefers-color-scheme: dark) {
    color: var(--color-text-primary-dark, #e0e0e0);
  }
}

.inputContainer {
  position: relative;

  // Ensure proper spacing for absolute positioned elements (like icons)
  :global(.input),
  :global(.select),
  :global(.textarea) {
    width: 100%;
  }
}

.field {
  display: flex;
  flex-direction: column;
  gap: var(--space-sm, 0.5rem);

  &.hasError {
    .inputContainer :global(.input),
    .inputContainer :global(.select),
    .inputContainer :global(.textarea) {
      border-color: var(--color-feedback-error, #dc3545);
      box-shadow: 0 0 0 2px rgb(220 53 69 / 10%);
    }
  }

  &.isDisabled {
    opacity: 0.6;
    pointer-events: none;
  }

  &.sm {
    gap: var(--space-xs, 0.25rem);

    .label {
      font-size: var(--text-size-sm, 0.875rem);
    }

    .description,
    .error {
      font-size: var(--text-size-xs, 0.75rem);
    }
  }

  &.lg {
    gap: var(--space-md, 1rem);

    .label {
      font-weight: var(--font-weight-semibold, 600);
      font-size: var(--text-size-lg, 1.25rem);
    }

    .description,
    .error {
      font-size: var(--text-size-base, 1rem);
  }
}

  // Focus styles for enhanced accessibility
  &:focus-within {
.label {
      color: var(--color-interactive-primary, #007acc);

  @media (prefers-color-scheme: dark) {
        color: var(--color-interactive-primary-dark, #4da6ff);
  }
    }
  }

  &.horizontal {
    flex-direction: row;
    gap: var(--space-md, 1rem);
    align-items: flex-start;

    .label {
      flex-shrink: 0;
      min-width: 120px;
      margin-bottom: 0;
      padding-top: calc(
        var(--space-xs, 0.25rem) + 1px
      ); // Align with input baseline
}

.inputContainer {
      flex: 1;
      min-width: 0; // Allow flex shrinking
    }

    &.sm {
      .label {
        min-width: 100px;
      }
    }

    &.lg {
      .label {
        min-width: 140px;
      }
    }
  }
}

.description {
  margin-top: var(--space-xs, 0.25rem);
  color: var(--color-text-secondary, #666666);
  font-size: var(--text-size-sm, 0.875rem);
  line-height: var(--text-line-height-relaxed, 1.6);

  @media (prefers-color-scheme: dark) {
    color: var(--color-text-secondary-dark, #cccccc);
  }
}

.error {
  margin-top: var(--space-xs, 0.25rem);
  color: var(--color-feedback-error, #dc3545);
  font-weight: var(--font-weight-medium, 500);
  font-size: var(--text-size-sm, 0.875rem);
  line-height: var(--text-line-height-relaxed, 1.6);
  animation: errorAppear 0.2s ease-out;

  @media (prefers-color-scheme: dark) {
    color: var(--color-feedback-error-dark, #ff6b7a);
  }

  // Error icon if present
  &::before {
    margin-right: var(--space-xs, 0.25rem);
    font-size: 0.8em;
    content: '⚠️';
  }
}

// Required field indicator
:global(.required-indicator) {
  margin-left: var(--space-xs, 0.25rem);
  color: var(--color-feedback-error, #dc3545);

  @media (prefers-color-scheme: dark) {
    color: var(--color-feedback-error-dark, #ff6b7a);
  }
}

@keyframes errorAppear {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}
