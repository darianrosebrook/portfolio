@use './Card.tokens.generated.scss' as cardTokens;

.card {
  @include cardTokens.vars;

  display: flex;
  flex-direction: column;
  padding: var(--card-size-padding-default);
  background-color: var(--card-color-background-default);
  border-radius: var(--card-size-radius-default);
  color: var(--card-color-foreground-primary);
  transition: all var(--card-motion-duration)
    var(--card-motion-easing);

  // CSS Containment for performance optimization
  contain: layout style paint;
  container-type: inline-size;

  // Container queries for responsive sizing
  @container (max-width: 20rem) {
    padding: calc(var(--card-size-padding-default) * 0.75);
  }

  @container (min-width: 40rem) {
    .actions {
      flex-direction: row;
      justify-content: space-between;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    transition: none;

    &.interactive:hover {
      transform: none;
    }

    &.interactive:active {
      transform: none;
    }
  }

  &.default {
    border: 1px solid var(--card-color-border-default);
  }

  &.elevated {
    border: none;
    box-shadow: var(--card-elevation-default);
  }

  &.outlined {
    background-color: transparent;
    border: 2px solid var(--card-color-border-default);
  }

  &.interactive {
    cursor: pointer;

    &:hover {
      // Use color-mix() for dynamic hover effect
      background-color: color-mix(
        in srgb,
        var(--card-color-background-default) 90%,
        var(--card-color-background-hover) 10%
      );
      box-shadow: var(--card-elevation-hover);
      transform: translateY(var(--card-motion-hover-offset, -0.125rem));
    }

    &:focus-visible {
      outline: 2px solid var(--card-color-border-accent);
      outline-offset: 2px;
    }

    &:active {
      transform: translateY(0);
    }
  }

  // Sub-components with scoped styles to prevent leakage
  .header {
    color: var(--card-color-foreground-primary);
    margin-block-end: var(--card-size-padding-default);

    &:has(.badge) {
      display: flex;
      gap: var(--card-size-gap-default);
      justify-content: space-between;
      align-items: center;
    }
  }

  .content {
    color: var(--card-color-foreground-primary);
    line-height: 1.5;
  }

  .title {
    margin: 0;
    color: var(--card-color-foreground-primary);
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-heading-4);
    line-height: var(--card-typography-lineHeight-heading);
  }

  .description {
    margin: 0;
    color: var(--card-color-foreground-secondary);
    font-size: var(--font-size-body-2);
    line-height: var(--card-typography-lineHeight-normal);
  }

  .media {
    margin-block-end: var(--card-size-padding-default);

    img,
    video {
      width: 100%;
      height: auto;
      border-radius: var(--card-size-radius-medium, 0.5rem);
    }
  }

  .footer {
    color: var(--card-color-foreground-secondary);
    border-block-start: 1px solid var(--card-color-border-default);
    margin-block-start: var(--card-size-padding-default);
    padding-block-start: var(--card-size-padding-default);
  }

  .actions {
    display: flex;
    gap: var(--card-size-gap-default);
    justify-content: flex-end;
    align-items: center;
    margin-block-start: var(--card-size-padding-default);
  }

  .link {
    display: inline-flex;
    gap: var(--card-size-gap-small);
    align-items: center;
    color: var(--card-color-foreground-link);
    font-weight: var(--font-weight-medium);
    text-decoration: none;

    &:hover {
      text-decoration: underline;
    }

    &:focus-visible {
      outline: 2px solid var(--card-color-border-accent);
      outline-offset: 2px;
    }
  }

  .note {
    padding: var(--card-size-padding-note);
    background-color: var(--card-color-background-secondary);
    border: 1px solid var(--card-color-border-default);
    border-radius: var(--card-size-radius-medium);
    color: var(--card-color-foreground-primary);
    font-style: italic;
    font-size: var(--font-size-body-3);
    margin-block-start: var(--card-size-padding-default);
  }

  // Badge styles
  .badge {
    display: inline-flex;
    align-items: center;
    padding: var(--card-size-padding-badgeY) var(--card-size-padding-badgeX);
    border-radius: var(--card-size-radius-full);
    font-weight: var(--font-weight-medium);
    font-size: var(--font-size-body-3);
    letter-spacing: 0.025em;
    text-transform: uppercase;

    &.completed {
      background-color: var(--card-color-badge-success-background);
      color: var(--card-color-badge-success-foreground);
    }

    &.in-progress {
      background-color: var(--card-color-badge-warning-background);
      color: var(--card-color-badge-warning-foreground);
    }

    &.planned {
      background-color: var(--card-color-badge-info-background);
      color: var(--card-color-badge-info-foreground);
    }

    &.deprecated {
      background-color: var(--card-color-badge-error-background);
      color: var(--card-color-badge-error-foreground);
    }

    &.category {
      background-color: var(--card-color-badge-neutral-background);
      color: var(--card-color-badge-neutral-foreground);
    }

    &.complexity {
      background-color: var(--card-color-badge-accent-background);
      color: var(--card-color-badge-accent-foreground);
    }
  }
}
