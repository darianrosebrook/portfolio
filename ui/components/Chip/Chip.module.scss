@use './Chip.tokens.generated.scss' as chipTokens;

.chip {
  @include chipTokens.vars;

  // Base styles
  display: inline-flex;
  gap: var(--chip-size-gap);
  align-items: center;
  padding: var(--chip-size-padding-vertical) var(--chip-size-padding-horizontal);
  background-color: var(--chip-color-background-default);
  border: var(--chip-size-border) solid var(--chip-color-border-default);
  border-radius: var(--chip-size-radius);
  color: var(--chip-color-foreground-default);
  font-weight: var(--chip-text-weight);

  // Typography
  font-size: var(--chip-text-size);
  line-height: var(--chip-text-lineHeight);
  transition:
    background-color var(--chip-motion-duration-fast)
      var(--chip-motion-easing-standard),
    border-color var(--chip-motion-duration-fast)
      var(--chip-motion-easing-standard),
    color var(--chip-motion-duration-fast) var(--chip-motion-easing-standard),
    transform var(--chip-motion-duration-fast)
      var(--chip-motion-easing-standard);

  // Interaction
  cursor: pointer;
  user-select: none;

  // Focus styles
  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--chip-focus-outlineWidth) solid var(--chip-focus-outlineColor);
    outline-offset: var(--chip-focus-outlineOffset);
  }

  // Hover and active states
  &:hover {
    // Use color-mix() for dynamic hover effect
    background-color: color-mix(
      in srgb,
      var(--chip-color-background-default) 90%,
      var(--chip-color-background-hover) 10%
    );
    border-color: color-mix(
      in srgb,
      var(--chip-color-border-default) 80%,
      var(--chip-color-border-hover) 20%
    );
    color: var(--chip-color-foreground-hover);
    text-decoration: none;
  }

  &:active {
    // Use color-mix() for dynamic active effect
    background-color: color-mix(
      in srgb,
      var(--chip-color-background-default) 85%,
      black 15%
    );
    border-color: color-mix(
      in srgb,
      var(--chip-color-border-default) 85%,
      black 15%
    );
    color: var(--chip-color-foreground-active);
    transform: scale(var(--chip-motion-scale-pressed));
  }

  // Selected variant (checkbox-like with checkmark)
  &.selected {
    background-color: var(--chip-color-background-selected);
    border-color: var(--chip-color-border-selected);
    color: var(--chip-color-foreground-selected);

    &:hover {
      // Use color-mix() for selected hover effect
      background-color: color-mix(
        in srgb,
        var(--chip-color-background-selected) 90%,
        white 10%
      );
      border-color: color-mix(
        in srgb,
        var(--chip-color-border-selected) 85%,
        white 15%
      );
      color: var(--chip-color-foreground-selectedHover);
    }

    &:active {
      background-color: color-mix(
        in srgb,
        var(--chip-color-background-selected) 85%,
        black 15%
      );
      border-color: color-mix(
        in srgb,
        var(--chip-color-border-selected) 85%,
        black 15%
      );
      color: var(--chip-color-foreground-selectedActive);
    }
  }

  // Dismissible variant (with X icon)
  &.dismissible {
    background-color: var(--chip-color-background-dismissible);
    border-color: var(--chip-color-border-dismissible);
    color: var(--chip-color-foreground-dismissible);

    &:hover {
      background-color: var(--chip-color-background-dismissibleHover);
      border-color: var(--chip-color-border-dismissibleHover);
      color: var(--chip-color-foreground-dismissibleHover);
    }

    &:active {
      background-color: var(--chip-color-background-dismissibleActive);
      border-color: var(--chip-color-border-dismissibleActive);
      color: var(--chip-color-foreground-dismissibleActive);
    }
  }

  // Icon styles
  .icon {
    display: flex;
    justify-content: center;
    align-items: center;
    width: var(--chip-size-icon-size);
    height: var(--chip-size-icon-size);
    color: var(--chip-color-icon-default);
    transition: color var(--chip-motion-duration-fast)
      var(--chip-motion-easing-standard);

    // Apply entrance animation
    animation: chip-icon-enter var(--chip-motion-duration-fast)
      var(--chip-motion-easing-out) forwards;
    margin-inline-start: var(--chip-size-icon-margin);

    svg {
      width: 100%;
      height: 100%;
    }
  }

  // Selected variant icon color
  &.selected .icon {
    color: var(--chip-color-icon-selected);
  }

  // Dismissible variant icon color
  &.dismissible .icon {
    color: var(--chip-color-icon-dismissible);
  }

  &.dismissible:hover .icon {
    color: var(--chip-color-icon-dismissibleHover);
  }

  // Text content
  .text {
    flex: 1;
    overflow: hidden;
    min-width: 0;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  // Disabled state
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    pointer-events: none;

    /* stylelint-disable-next-line no-descending-specificity */
    .icon {
      opacity: 0.6;
    }
  }
}

// Animation keyframes for icon entrance/exit
@keyframes chip-icon-enter {
  from {
    opacity: 0;
    transform: scale(var(--chip-motion-scale-iconEnter));
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes chip-icon-exit {
  from {
    opacity: 1;
    transform: scale(1);
  }

  to {
    opacity: 0;
    transform: scale(var(--chip-motion-scale-iconExit));
  }
}

// Reduced motion preferences
@media (prefers-reduced-motion: reduce) {
  .chip {
    transition: none;

    &:active {
      transform: none;
    }
  }

  .icon {
    animation: none;
  }
}
