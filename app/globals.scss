@use 'reset';
@use 'vars';

@view-transition {
  navigation: auto;
}

@keyframes slide-and-fade-out {
  from {
    opacity: 1;
    transform: translateY(0);
  }

  to {
    opacity: 0;
    transform: translateY(-100%);
  }
}

@keyframes slide-and-fade-in {
  from {
    opacity: 0;
    transform: translateY(100%);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

:root {
  font-weight: var(--font-weight-regular);
  font-size: var(--body-02);

  /* Typography */

  font-family: var(--font-inter), sans-serif;
  line-height: var(--line-height-body);
  letter-spacing: var(--letter-spacing-tight);
  font-feature-settings:
    'case' 0,
    'dlig',
    'frac' 0,
    'dnom' 0,
    'numr' 0,
    'subs' 0,
    'sups' 0,
    'tnum' 0,
    'zero' 0,
    'ss01' 0,
    'ss02' 0,
    'ss03',
    'ss04',
    'ss05' 0,
    'ss06' 0,
    'ss07' 0,
    'ss08' 0,
    'cv01',
    'cv02' 0,
    'cv03' 0,
    'cv04' 0,
    'cv05' 0,
    'cv06' 0,
    'cv07',
    'cv08' 0,
    'cv09' 0,
    'cv10' 0,
    'cv11' 0,
    'cv12' 0,
    'cv13' 0,
    'cpsp' 0,
    'c2sc' 0,
    'salt' 0,
    'aalt' 0,
    'calt',
    'ccmp',
    'locl',
    'kern';

  p + p {
    margin-top: var(--size-04);
  }

  strong {
    font-weight: var(--font-weight-bold);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-weight: 300;
    font-family: var(--font-nohemi), sans-serif;
    line-height: var(--line-height-collapse);
    letter-spacing: var(--letter-spacing-wide);
    text-wrap: balance;

    & strong {
      font-weight: 400;
    }
  }

  .heading-01,
  h1 {
    font-size: var(--heading-01);
  }

  .heading-02,
  h2 {
    font-size: var(--heading-02);
  }

  .heading-03,
  h3 {
    font-size: var(--heading-03);
  }

  .heading-04,
  h4 {
    font-size: var(--heading-04);
  }

  .heading-05,
  h5 {
    font-size: var(--heading-05);
  }

  .heading-06,
  h6 {
    font-size: var(--heading-06);
  }

  .heading-hero {
    font-size: var(--oversize-03);
  }

  .heading-super {
    font-size: var(--oversize-01);
  }

  // Accessibility utility
  .sr-only {
    position: absolute;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    width: 1px;
    height: 1px;
    margin: -1px;
    padding: 0;
    border: 0;
    white-space: nowrap;
  }

  .button-01 {
    font-size: var(--button-01);
  }

  .button-02 {
    font-size: var(--button-02);
  }

  .button-03 {
    font-size: var(--button-03);
  }

  .caption-01 {
    font-size: var(--caption-01);
  }

  .caption-02,
  small,
  .small {
    font-size: var(--caption-02);
  }

  .caption-03,
  .smallest {
    font-size: var(--caption-03);
  }

  .body-01,
  .medium {
    font-size: var(--body-01);
  }

  .body-02 {
    font-size: var(--body-02);
  }

  .body-03,
  .regular {
    font-size: var(--body-03);
  }

  .body-04 {
    font-size: var(--body-04);
  }

  .bold {
    font-weight: var(--font-weight-bold);
  }

  .body {
    font-weight: var(--font-weight-regular);
  }

  .emphasis,
  em {
    font-style: italic;
  }

  .uppercase {
    text-transform: uppercase;
    font-feature-settings: 'case' 1;
  }

  .underline {
    text-decoration: underline;
  }

  .super,
  .sups,
  sup {
    top: -0.5em;
    vertical-align: super;
    font-size: var(--caption-03);
  }

  .sub,
  sub {
    bottom: -0.25em;
    vertical-align: sub;
    font-size: var(--caption-03);
  }

  sub,
  .sub,
  sup,
  .sup {
    position: relative;
    vertical-align: baseline;
    line-height: 0;
  }

  .smallest {
    font-size: var(--caption-02);
  }

  abbr[title] {
    border-bottom: none;
    text-decoration: underline;
    text-decoration: underline dotted;
  }

  code,
  kbd,
  samp,
  pre {
    font-size: 1em;
    font-family: monospace;
  }

  .elevated {
    --elevation:
      var(--depth) 0.25px 0.75px rgb(20 20 20 / var(--opacity-100)),
      0px 0.125px 0.25px rgb(20 20 20 / var(--opacity-50));

    box-shadow: var(--elevation);
  }

  .elevation-1 {
    /* override depth here */
    --depth: var(--depth-1);
  }

  .elevation-2 {
    --depth: var(--depth-2);
  }

  .elevation-3 {
    --depth: var(--depth-3);
  }

  .elevation-4 {
    --depth: var(--depth-4);
  }
}

.secondary {
  color: var(--color-foreground-secondary);
}

*::selection {
  background: var(--color-background-highlight);
  color: var(--color-foreground-highlight);
}

h4,
h3 {
  span {
    display: block;
    color: var(--color-foreground-secondary);
    font-weight: var(--font-weight-light);
  }
}

/* Gooey text highlighting */
.text-highlighted {
  position: relative;
  z-index: 1;
  filter: url('#goo-text');
}

.text-highlighted > span {
  padding: var(--size-02) var(--size-03);
  background: var(--color-background-highlight);
  border-radius: var(--radius-01);
  box-decoration-break: clone;
  color: var(--color-foreground-highlight);
  transition: all 0.2s ease;
}

/* Gooey selection styling */
::selection {
  background: var(--color-background-highlight);
  color: var(--color-foreground-highlight);

  /* Note: ::selection doesn't support pseudo-elements, so we can't use gooey filter here
     without blurring the text. The gooey effect will be handled by CSS Custom Highlight API
     for programmatic selections, and manual highlighting for static content. */
}

/* Enhanced selection styling for gooey effect */
::highlight(gooey-highlight) {
  padding: var(--size-01) var(--size-02);
  background: var(--color-background-highlight);
  border-radius: var(--radius-01);
  box-decoration-break: clone;
  color: var(--color-foreground-highlight);
  transition: all 0.2s ease;
  animation: gooeyHighlightFadeIn 0.3s ease-out;

  /* Use a very subtle blur to avoid text obscuring */
  filter: url('#goo-text-subtle');
}

/* Fallback for browsers that don't support CSS Custom Highlight API */
@supports not (CSS.highlights) {
  *::selection {
    background: var(--color-background-highlight);
    border-radius: var(--radius-01);
    color: var(--color-foreground-highlight);
  }
}

/* Mark element styling with gooey effect */
mark {
  padding: var(--size-01) var(--size-02);
  background: var(--color-background-highlight);
  border-radius: var(--radius-01);
  box-decoration-break: clone;
  color: var(--color-foreground-highlight);
  transition: all 0.2s ease;
  filter: url('#goo-text');
}

/* Animation for highlighted text */
@keyframes highlightFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Wrapper for gooey highlighting that keeps text crisp */
.gooey-highlight-wrapper {
  position: relative;
  display: inline;
  filter: url('#goo-text');

  > span {
    position: relative;
    z-index: 2;
    padding: var(--size-01) var(--size-02);
    background: var(--color-background-highlight);
    border-radius: var(--radius-01);
    box-decoration-break: clone;
    color: var(--color-foreground-highlight);
    transition: all 0.2s ease;
  }
}

.text-highlighted > span,
mark {
  animation: highlightFadeIn 0.3s ease-out;
}

.gooey > span {
  padding: var(--size-05) var(--size-05);
  background: var(--color-background-primary);

  /* make sure the padding apply to all the lines */
  box-decoration-break: clone;
  color: var(--color-foreground-primary);
}

/* Hover effects for highlighted text */
.text-highlighted:hover {
  > span,
  mark:hover {
    background: var(--color-background-tertiary);
    transform: scale(1.02);
  }
}

/* Animation for CSS Custom Highlight API highlights */
@keyframes gooeyHighlightFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

[hidden] {
  display: none;
}

template {
  display: none;
}

input,
button,
textarea,
select {
  font: inherit;
}

/* structure   */
html {
  line-height: var(--line-height);
  -webkit-font-smoothing: antialiased;
  text-size-adjust: 100%;
}

html,
body {
  max-width: 100vw;
  margin: 0;
}

body {
  position: relative;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background: var(--color-background-primary);
  color: var(--color-foreground-primary);
}

body::before {
  position: fixed;
  top: 0;
  left: 0;
  z-index: 3023023023020;
  width: 100%;
  height: 100%;
  opacity: 0.15;
  color: var(--color-foreground-primary);
  filter: url('#grainy');
  pointer-events: none;
  content: '';
}

body > svg {
  position: absolute;
  top: 0;
  left: 0;
  cursor: none;
  pointer-events: none;
}

svg:has(#grainy) {
  position: absolute;
  top: 0;
  left: 0;
  cursor: none;
  pointer-events: none;
}

main {
  display: flex;
  flex-grow: 1;
  flex-direction: column;
  overflow-x: hidden;
  width: 100%;
  margin: auto;
  padding-top: 5vh;
  transition-property: transform, filter;
  view-transition-name: main;
}

::view-transition-old(main),
::view-transition-new(main) {
  animation: none !important;
}

::view-transition-group(main) {
  z-index: auto !important;
}

::view-transition-image-pair(main) {
  z-index: 1;
  isolation: isolate;
  will-change: transform, opacity, clip-path;
}

::view-transition-new(main) {
  z-index: 200;
  animation: none !important;
}

::view-transition-old(main) {
  z-index: 1;
  animation: none !important;
}

section {
  min-height: 20vh;
}

section,
header,
footer {
  width: 100%;
  margin: 0 auto;
}

section:not(:first-of-type) + section {
  margin-top: var(--size-10);
}

hr {
  overflow: visible;
  box-sizing: content-box;
  height: 0;
  margin: var(--size-07) 0;
  border: none;
  border-top: 1px solid var(--color-foreground-primary);
}

progress {
  vertical-align: baseline;
}

ul {
  margin: 0;
  padding: 0 0 0 1rem;
}

/* Graphics / Visuals */
img,
picture,
video,
canvas {
  border-radius: var(--size-03);
}

.avatar {
  border-radius: var(--radius-full);
}

a {
  color: var(--color-foreground-accent, inherit);
  text-decoration: none;
}

a:focus-visible,
a:focus {
  border-radius: var(--radius-01);
}

a:hover {
  text-decoration: underline;
}

// FontAwesome styles removed - using local SVG icons instead

.social-link {
  display: inline-flex;
  align-items: center;
  margin: 0;
  margin-left: var(--size-02);
  font-size: var(--heading-05);
}

/* Interactive UI */

button,
[type='button'],
[type='reset'],
[type='submit'] {
  background: none;
  border: none;
  cursor: pointer;
  appearance: button;
}

button::-moz-focus-inner,
[type='button']::-moz-focus-inner,
[type='reset']::-moz-focus-inner,
[type='submit']::-moz-focus-inner {
  padding: 0;
  border-style: none;
}

button:-moz-focusring,
[type='button']:-moz-focusring,
[type='reset']:-moz-focusring,
[type='submit']:-moz-focusring {
  outline: var(--focus-ring);
  outline-offset: var(--focus-ring-offset);
}

article > * + * {
  margin-top: var(--size-06);

  & > * + * {
    margin-top: var(--size-04);

    & > * + * {
      margin-top: var(--size-03);
    }
  }
}

/* Form Elements */
.form-widget > * + * {
  margin-top: var(--size-06);
}

label {
  display: block;
  font-weight: var(--font-weight-medium);
}

textarea {
  min-height: 10em;
  resize: none;
  scrollbar-color: var(--color-foreground-primary)
    var(--color-background-primary);
}

input,
textarea {
  width: 100%;
  max-width: 30em;
  min-height: var(--tap-target-large);
  padding: var(--size-03) var(--size-04);
  background: var(--color-background-input);
  border: 1px solid var(--color-border-primary);
  border-radius: var(--radius-02);
  color: var(--color-foreground-primary);
  transition: border 0.2s ease;
  resize: vertical;
}

textarea + label {
  margin-top: var(--size-06);
}

label + input[type='text'],
label + input[type='email'],
label + input[type='password'],
label + textarea {
  margin-top: var(--size-03);
}

input[type='text'] + label,
input[type='email'] + label,
input[type='password'] + label,
input:focus-visible,
textarea:focus-visible {
  border-color: var(--color-border-bold);
  outline: var(--focus-ring);
  outline-offset: var(--focus-ring-offset);
}

input:read-only,
textarea:read-only {
  background: var(--color-background-read-only);
  border-color: var(--color-foreground-primary);
  outline: none;
  color: var(--secondary);
}

input:disabled,
textarea:disabled {
  background: var(--color-background-secondary);
  border-color: var(--color-border-disabled);
  color: var(--color-foreground-disabled);
}

input[type='range'] {
  width: 100%;
  min-height: 20px;
  padding: 0;
  background: linear-gradient(
    to right,
    var(--color-foreground-primary),
    var(--color-foreground-secondary)
  );
  border: none;
  border-radius: var(--radius-02);
  transition: background 0.2s ease;
  cursor: pointer;

  &:focus-visible {
    outline: var(--focus-ring);
    outline-offset: var(--focus-ring-offset);
  }
}

/* Typography */
.content {
  display: flex;
  flex-direction: column;
  gap: var(--size-06);
  max-width: 1440px;
  margin: 0 auto;
  padding: 0 var(--size-06);
}

* + .content {
  margin-top: var(--size-07);
}

.experience {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--grid-gap-medium);
  padding-left: 0;
  list-style-type: none;
}

.experience > li {
  margin: 0;
  margin-top: var(--size-04);
}

article ul,
article ol {
  padding-left: 1rem;
}

.two-up {
  display: flex;
  gap: var(--size-04);
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--grid-gap-medium);
  align-content: stretch;
}

.card {
  padding: var(--size-06);
  background: var(--color-background-primary);
  border-radius: var(--radius-02);
  box-shadow: var(--elevation);
  transition: box-shadow 0.2s ease;
}

.card a {
  color: var(--color-foreground-primary);
}

.card > * + * {
  margin-top: var(--size-06);
}

.card img {
  width: 100%;
}

.meta {
  display: flex;
  gap: var(--size-03);
  justify-content: space-between;
  align-items: center;
}

tr {
  padding: var(--size-07);
  border-top: 1px solid var(--color-foreground-primary);
}

thead tr:first-of-type {
  border-top: none;
}

header + main {
  margin-top: 5vh;
}

.menuList {
  display: flex;
  flex-direction: column;
  gap: var(--size-06);
  margin: 0;
  padding: 0;
  list-style: none;
}

.menuItem {
  display: flex;
  align-items: center;
  width: 100%;
  padding: var(--size-04);
  border-radius: var(--size-04);
  box-shadow: var(--shadow-01);
  transition: var(--transition);

  &:hover {
    background: var(--color-background-tertiary);
  }
}

.gooey {
  z-index: 9999;
  filter: url('#goo');
}

// Grids
.three-up {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--size-06);

  p + p {
    margin-top: 0;
  }
}

#pest {
  position: absolute;
  display: block;
  box-sizing: border-box;
  border: 2px solid var(--color-border-bold);
  border-radius: 999px;
  pointer-events: none;
}

#pest span {
  display: block;
  min-width: 40px;
  min-height: 40px;
  border-radius: 1920px;
  transition: border ease 0.2s;
}

.backdropContainer {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden;
  width: 100%;
  height: 100%;
}

.avatarFlag {
  display: flex;
  gap: var(--size-06);
  align-items: center;
}

.flag {
  display: inline-block;

  & .icon {
    margin-right: var(--size-03);
  }

  & p:last-of-type {
    margin-top: 0;
    color: var(--color-foreground-secondary);
  }
}

.projects ul {
  gap: var(--size-10);
}

@keyframes animatedBackground {
  from {
    background-position: 0 0;
  }

  /* use negative width if you want it to flow right to left else and positive for left to right */
  to {
    background-position: 0 -10000px;
  }
}

.glossary-list {
  list-style: none;
}

.glossary-letter-header {
  display: flex;
  justify-content: space-between;
  height: auto;
  padding-bottom: var(--size-10);
  line-height: 4rem;

  a {
    display: flex;
    gap: var(--size-04);
    align-items: center;
    color: var(--color-foreground-secondary);
  }
}

.glossary-letters {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(48px, 1fr));
  gap: var(--size-03);
  margin-top: 0;
  padding-left: 0;
  font-size: var(--heading-05);
  list-style: none;

  a {
    font-weight: var(--font-weight-medium);
  }
}

.glossary-item h4 {
  display: flex;
  grid-column: span 1;
  gap: var(--size-05);
  justify-content: space-between;
  align-items: center;
}

.sub-list {
  margin-top: 0;
  padding-top: var(--size-10);
  padding-left: 0;
  border-top: 1px solid var(--color-border-primary);
  list-style: none;
}

@media screen and (width >= 1000px) {
  .gooey > span {
    padding: var(--size-06) var(--size-06);
  }

  .content {
    max-width: 1440px;
    padding: 0 var(--size-06);
  }

  section.home {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    max-width: 1440px;
    margin: 0 auto;
  }

  main section + section {
    display: block;
    margin-top: var(--size-07);
  }

  main .hero {
    align-self: center;
  }

  .glossary-letters {
    display: flex;
    flex-wrap: wrap;
    gap: var(--size-03);
  }

  .glossary-letter {
    display: inline-block;
    margin-right: var(--size-03);
    font-weight: var(--font-weight-bold);
    list-style: none;
  }

  .content .glossary-list {
    display: grid;
    grid-template-columns: 1fr 1fr 3fr;
    gap: var(--size-06);
    align-items: start;
    margin: 0 auto;
  }

  .glossary-list dd {
    grid-column: span 1;
    align-self: start;
    margin-top: 0;
  }

  .glossary-list .sub-list {
    display: grid;
    grid-template-columns: subgrid;
    grid-column: span 3;
    gap: var(--size-06);
    margin-top: 0;
    padding-left: 0;

    dl {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-column: span 2;
      gap: var(--size-06);
      align-items: start;

      .glossary-item {
        padding: var(--size-03) var(--size-04);
        border-radius: var(--radius-02);
        transition: all 0.2s ease;

        &:hover {
          background: var(--color-background-highlight);
          color: var(--color-foreground-highlight);

          & + dd {
            background: var(--color-background-highlight);
            color: var(--color-foreground-highlight);
          }
        }

        &:has(+ dd:hover) {
          background: var(--color-background-highlight);
          color: var(--color-foreground-highlight);
        }
      }

      dt h4 {
        display: flex;
        grid-column: span 1;
        gap: var(--size-05);
        justify-content: space-between;
        align-items: center;
      }
    }
  }

  .glossary-letter-header {
    flex-direction: column;
    justify-content: flex-start;
    line-height: 4rem;

    a {
      opacity: 0.5;
      transition: opacity 0.2s ease;
    }

    &:hover a {
      opacity: 1;
    }

    &:hover a span {
      transform: rotate(180deg);
    }
  }

  .experience li {
    display: grid;

    /* date place description */
    grid-template-columns: 1fr 1fr 3fr;
    gap: 2rem;
  }

  .experience .content {
    margin-top: 0;
  }

  .card {
    flex-direction: column;
  }

  .card .media {
    width: 100%;
    margin-right: 0;
  }

  .card .media + div {
    margin-top: var(--size-04);
  }

  .meta {
    flex-direction: row;
    align-items: center;
  }

  .meta .byline {
    flex-direction: row;
    gap: var(--size-03);
    align-items: center;
  }
}

img.align-left {
  float: left;
  margin-right: 1rem;
}

img.align-right {
  float: right;
  margin-left: 1rem;
}

img.align-center {
  display: block;
  margin-right: auto;
  margin-left: auto;
}
